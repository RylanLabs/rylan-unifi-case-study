---
# Rylan Policy Table v5.0 - Zero-Trust Allows Only (7 rules)
rules:
  - description: "Management → Everywhere (controller + SSH)"
    source:
      network: "Management"
    destination:
      type: "any"
    action: "accept"
    ports: ["22", "443", "8443", "161"]

  - description: >-
      trusted-devices → servers (DNS, AD, NFS, Influx, PXE)
    source:
      network: "trusted-devices"
    destination:
      network: "servers"
    action: "accept"
    ports: ["53", "67", "68", "69", "88", "389", "636", "2049",
            "4011", "8086"]
    comment: "Consolidated server access including PXE boot"

  - description: "trusted-devices → voip (SIP + RTP)"
    source:
      network: "trusted-devices"
    destination:
      network: "voip"
    action: "accept"
    ports: ["5060-5061", "10000-20000"]

  - description: "servers → osTicket (AI triage polling)"
    source:
      network: "servers"
      address: "10.0.10.60"
    destination:
      address: "10.0.30.40"
      ports: ["80", "443"]
    action: "accept"

  - description: "voip → servers (FreePBX → AD auth)"
    source:
      network: "voip"
    destination:
      network: "servers"
      ports: ["389", "636"]
    action: "accept"

  - description: "guest-iot → WAN only (block local)"
    source:
      network: "guest-iot"
    destination:
      type: "internet"
    action: "accept"

  - description: "guest-iot → local (drop everything else)"
    source:
      network: "guest-iot"
    destination:
      type: "local"
    action: "drop"

  - description: "IoT-Isolated → Internet (Whitelist)"
    source:
      network: "iot-isolated"
    destination:
      type: "internet"
    action: "accept"
    ports: ["443", "8883"]
    comment: "Traeger grill cloud access only (TLS + MQTT over TLS)"

  - description: "IoT-Trusted → Streaming Services"
    source:
      network: "iot-trusted"
    destination:
      type: "internet"
    action: "accept"
    ports: ["80", "443"]
    comment: "Denon HEOS soundbars - Spotify/Pandora/HEOS cloud"
